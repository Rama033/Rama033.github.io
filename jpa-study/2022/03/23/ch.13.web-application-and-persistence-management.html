<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>[자바 ORM 표준 JPA 프로그래밍] 13장. 웹 애플리케이션과 영속성 관리</title>
  <meta name="description" content="13장. 웹 애플리케이션과 영속성 관리">
  
  <meta name="author" content="Jo">
  <meta name="copyright" content="&copy; Jo 2022">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="13장. 웹 애플리케이션과 영속성 관리" />
  <meta property="og:url" content="https://sungunjo.github.io/jpa-study/2022/03/23/ch.13.web-application-and-persistence-management.html">
  <meta property="og:site_name" content="Development Stash" />
  <meta property="og:title" content="[자바 ORM 표준 JPA 프로그래밍] 13장. 웹 애플리케이션과 영속성 관리" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://sungunjo.github.io/assets/instacode.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[자바 ORM 표준 JPA 프로그래밍] 13장. 웹 애플리케이션과 영속성 관리">
  <meta name="twitter:description" content="13장. 웹 애플리케이션과 영속성 관리">
  <meta name="twitter:image" content="https://sungunjo.github.io/assets/instacode.png">
  <meta name="twitter:url" content="https://sungunjo.github.io/jpa-study/2022/03/23/ch.13.web-application-and-persistence-management.html">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://sungunjo.github.io/jpa-study/2022/03/23/ch.13.web-application-and-persistence-management.html">
	<link rel="alternate" type="application/rss+xml" title="Development Stash" href="https://sungunjo.github.io/feed.xml" />
	
	<!-- Tooltips -->
	<script type="text/javascript">
		window.tooltips = []
	</script>
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/logo.png" alt="Development Stash">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
				
	
	<li class="nav-link"><a href="/about/">About</a>
	

	

	

	
	<li class="nav-link"><a href="/posts/">Posts</a>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	


      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container has-cover" style="background-image: url(/assets/instacode.png);">
  <div class="scrim has-cover">
    <header class="post-header">
      <h1 class="title">[자바 ORM 표준 JPA 프로그래밍] 13장. 웹 애플리케이션과 영속성 관리</h1>
      <p class="info">by <strong>Jo</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">



<section class="post-meta">
  <div class="post-date">March 23, 2022</div>
  <div class="post-categories">
  in 
    
    <a href="/category/jpa-study">Jpa-study</a>
    
  
  </div>
</section>

<article class="post-content">
  <h1 id="13장-웹-애플리케이션과-영속성-관리">13장. 웹 애플리케이션과 영속성 관리</h1>

<p><br /></p>

<h1 id="131-트랜잭션-범위의-영속성-컨텍스트">13.1 트랜잭션 범위의 영속성 컨텍스트</h1>
<ul>
  <li>순수 J2SE 환경에선 개발자가 직접 엔티티 매니저 생성하고 트랜잭션 관리</li>
  <li>스프링, J2EE 컨테이너 환경에서 JPA 사용시엔 컨테이너가 제공하는 전략 따라야 함</li>
</ul>

<p><br /></p>

<h1 id="1311-스프링-컨테이너의-기본-전략">13.1.1 스프링 컨테이너의 기본 전략</h1>
<ul>
  <li><strong>트랜잭션 범위의 영속성 컨텍스트</strong> 가 기본 전략
    <ul>
      <li>트랜잭션 시작시 영속성 컨텍스트를 생성하고 트랜잭션 끝날 때 영속성 컨텍스트 종료</li>
      <li>같은 트랜잭션 안에서는 항상 같은 영속성 컨텍스트에 접근</li>
    </ul>
  </li>
</ul>

<p><img src="/assets/img/jpa_study/ch.13/pic-13-1.png" /></p>

<p><br /></p>

<p><img src="/assets/img/jpa_study/ch.13/pic-13-2.png" /></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@Transactional</code> 어노테이션 사용하면 메소드 실행 직전에 스프링의 트랜잭션 AOP가 먼저 동작
    <ul>
      <li>스프링 트랜잭션 AOP는 대상 메소드 호출 전 트랜잭션을 시작</li>
      <li>대상 메소드 정상 종료시 트랜잭션을 커밋하면서 종료
        <ul>
          <li>트랜잭션을 커밋하면 JPA는 먼저 영속성 컨텍스트 플러시해서 변경 내용 DB 반영 후에 DB 트랜잭션을 커밋함</li>
          <li>예외 발생시 트랜잭션을 롤백하고 종료하며 플러시 호출 안함</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="동일-트랜잭션-동일-영속성-컨텍스트">동일 트랜잭션, 동일 영속성 컨텍스트</h3>
<ul>
  <li>다양한 위치에서 엔티티 매니저 주입받아 사용해도 트랜잭션이 같으면 동일한 영속성 컨텍스트를 사용함</li>
</ul>

<p><img src="/assets/img/jpa_study/ch.13/pic-13-3.png" /></p>

<p><br /></p>

<h3 id="다른-트랜잭션-다른-영속성-컨텍스트">다른 트랜잭션, 다른 영속성 컨텍스트</h3>
<ul>
  <li>여러 스레드에서 동시에 요청 와서 같은 엔티티 매니저 사용해도 트랜잭션이 다르면 서로 다른 영속성 컨텍스트를 사용
    <ul>
      <li>스프링 컨테이너는 스레드마다 각기 다른 트랜잭션을 할당함</li>
    </ul>
  </li>
</ul>

<p><img src="/assets/img/jpa_study/ch.13/pic-13-4.png" /></p>

<p><br />
<br />
<br /></p>

<h1 id="132-준영속-상태와-지연-로딩">13.2 준영속 상태와 지연 로딩</h1>
<ul>
  <li>트랜잭션 범위의 영속성 컨텍스트 전략에서 트랜잭션은 보통 서비비스 레이어에서 시작되고 끝남</li>
  <li>∴ 컨트롤러, 뷰와 같은 프리젠테이션 레이어에서는 영속성 컨텍스트가 없어 준영속 상태임
    <ul>
      <li>변경 감지, 지연 로딩 동작 안함</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="준영속-상태와-변경-감지">준영속 상태와 변경 감지</h3>
<ul>
  <li>프리젠테이션 레이어에서는 데이터 수정 안되는게 레이어 간 책임 더 확실해지고 좋음</li>
  <li>∴ 문제 안됨</li>
</ul>

<p><br /></p>

<h3 id="준영속-상태와-지연-로딩">준영속 상태와 지연 로딩</h3>
<ul>
  <li>프리젠테이션 레이어에서 지연 로딩 사용하면 예외 발생함</li>
  <li>해결 방법은 크게 두 가지
    <ul>
      <li>OSIV 사용해서 엔티티를 항상 영속 상태로 유지</li>
      <li>뷰에서 필요한 엔티티를 미리 로딩
        <ul>
          <li>영속성 컨텍스트가 살아있을 때 미리 다 로딩하거나 초기화해서 반환해두는 방법</li>
          <li>어디서 미리 로딩해두는 지에 따라 세 가지 방법이 있음
            <ul>
              <li><strong>글로벌 페치 전략 수정</strong></li>
              <li><strong>JPQL 페치 조인</strong></li>
              <li><strong>강제로 초기화</strong></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><br />
<br /></p>

<h2 id="1321-글로벌-페치-전략-수정">13.2.1 글로벌 페치 전략 수정</h2>
<ul>
  <li>글로벌 페치 전략을 lazy loading 에서 eager로 수정
    <ul>
      <li><code class="language-plaintext highlighter-rouge">@ManyToOne(fetch = FetchType.EAGER)  // 즉시 로딩 전략 설정</code></li>
    </ul>
  </li>
  <li>엔티티에 있는 fetch 타입 변경하면 애플리케이션 전체에서 해당 엔티티 로딩할 때마다 설정한 전략을 사용함</li>
</ul>

<p><br /></p>

<h3 id="글로벌-페치-전략에-즉시-로딩-사용-시-단점">글로벌 페치 전략에 즉시 로딩 사용 시 단점</h3>
<ul>
  <li><strong>사용하지 않는 엔티티를 로딩함</strong>
    <ul>
      <li>한 곳에서 즉시 로딩 필요해서 설정해두면 필요 없는 다른 곳에서 조회해서 사용할때도 언제나 즉시 로딩됨</li>
    </ul>
  </li>
  <li><strong>N+1 문제 발생</strong>
    <ul>
      <li>JPA가 JPQL 분석해서 SQL 생성 시 글로벌 페치 전략 참고하지 않고 오직 JPQL 만 사용
        <ol>
          <li>JPQL 분석해서 SQL 생성</li>
          <li>생성한 쿼리로 DB 조회해서 엔티티 인스턴스들 생성</li>
          <li>글로벌 페치 전략이 즉시 로딩으로 설정된 엔티티면 연관된 엔티티도 로딩해야 함</li>
          <li>연관된 엔티티를 영속성 컨텍스트에서 조회</li>
          <li>없으면 연관된 엔티티 조회하는 쿼리를 2번에서 조회된 엔티티 수만큼 실행</li>
        </ol>
      </li>
      <li>JPQL 페치 조인으로 해결 가능</li>
    </ul>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// N+1 문제 JPQL 예시</span>
<span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> 
  <span class="s">"SELECT o "</span> <span class="o">+</span>
  <span class="s">"FROM Order o "</span><span class="o">;</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
  <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span> <span class="c1">// 연관된 모든 엔티티 조회</span>
</code></pre></div></div>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="err">실제</span> <span class="err">실행되는</span> <span class="k">SQL</span> 
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">order</span> <span class="o">#</span> <span class="n">JPQL</span><span class="err">로</span> <span class="err">실행된</span> <span class="k">SQL</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">member</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=?</span> <span class="o">//</span> <span class="n">EAGER</span><span class="err">로</span> <span class="err">실행된</span> <span class="k">SQL</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">member</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=?</span> <span class="o">//</span> <span class="n">EAGER</span><span class="err">로</span> <span class="err">실행된</span> <span class="k">SQL</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">member</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=?</span> <span class="o">//</span> <span class="n">EAGER</span><span class="err">로</span> <span class="err">실행된</span> <span class="k">SQL</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">member</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=?</span> <span class="o">//</span> <span class="n">EAGER</span><span class="err">로</span> <span class="err">실행된</span> <span class="k">SQL</span>
<span class="p">...(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="k">order</span> <span class="err">결과</span> <span class="err">수만큼</span> <span class="err">반복됨</span><span class="p">)</span>
</code></pre></div></div>

<p><br />
<br /></p>

<h2 id="1322-jpql-페치-조인">13.2.2 JPQL 페치 조인</h2>
<ul>
  <li>JPQL 호출 시점에 함께 로딩할 엔티티를 선택할 수 있음</li>
  <li>fetch join 사용하면 JPQL에서 연관된 엔티티도 같이 조회하기 때문에 추가적으로 엔티티 조회 안함 =&gt; N+1 문제 해결</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// N+1 문제 발생했던 예시에 페치 조인 사용하여 문제 해결</span>
<span class="nc">String</span> <span class="n">query</span> <span class="o">=</span> 
  <span class="s">"SELECT o "</span> <span class="o">+</span>
  <span class="s">"FROM Order o "</span>
  <span class="s">"JOIN FETCH o.member "</span><span class="o">;</span> <span class="c1">// fetch join으로 JPQL이 연관된 엔티티도 함께 조회해서 로딩하도록 함</span>

<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
  <span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div>

<p><br /></p>

<h3 id="jpql-페치-조인의-단점">JPQL 페치 조인의 단점</h3>
<ul>
  <li>무분별하게 사용시 화면에 맞춘 레포지토리 메소드가 증가
    <ul>
      <li>뷰와 레포지토리 간 논리적 의존 관계가 발생</li>
      <li>∴ 프리젠테이션 레이어가 데이터 엑세스 레이어를 침범하는 결과를 낳음</li>
    </ul>
  </li>
</ul>

<p><br />
<br /></p>

<h2 id="1323-강제로-초기화">13.2.3 강제로 초기화</h2>
<ul>
  <li>영속성 컨텍스트가 살아있을 때 프리젠테이션 레이어에서 필요한 엔티티를 강제로 초기화해서 리턴하는 방법</li>
  <li>하이버네이트에서는 <code class="language-plaintext highlighter-rouge">initialize()</code> 메소드를 사용해 강제로 초기화할 수도 있음</li>
  <li>JPA 표준에는 프록시 초기화 메소드는 없고 초기화여부 확인은 가능함</li>
  <li>이렇게 프록시 초기화를 서비스 레이어에서 담당하게 되면 JPQL 페치 조인 때처럼 프리젠테이션 레이어가 서비스 레이어를 침범하는 상황이 됨
    <ul>
      <li>∴ 프리젠테이션 레이어를 위한 프록시 초기화 역할을 분리해야 함 =&gt; FACADE 레이어</li>
    </ul>
  </li>
</ul>

<details>
<summary style="color:rgb(200, 50, 50)"><b>코드</b></summary>
<div>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 프록시 강제 초기화 예시</span>
<span class="kd">class</span> <span class="nc">OrderService</span> <span class="o">{</span>
  <span class="nd">@Transactional</span>
  <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">findOrder</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">orderRepository</span><span class="o">.</span><span class="na">findOrder</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>

    <span class="n">order</span><span class="o">.</span><span class="na">getMember</span><span class="o">().</span><span class="na">getName</span><span class="o">();</span>  <span class="c1">// 프록시 객체 강제 초기화</span>

    <span class="k">return</span> <span class="n">order</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="c1">// 하이버네이트에서 강제 초기화 예시</span>
<span class="kd">class</span> <span class="nc">OrderService</span> <span class="o">{</span>
  <span class="nd">@Transactional</span>
  <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">findOrder</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">orderRepository</span><span class="o">.</span><span class="na">findOrder</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>

    <span class="nc">Hibernate</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="n">order</span><span class="o">.</span><span class="na">getMember</span><span class="o">());</span>  <span class="c1">// 프록시 객체 강제 초기화</span>

    <span class="k">return</span> <span class="n">order</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="c1">// JPA 표준에서의 프록시 초기화 여부 확인 코드</span>
<span class="nc">PersistenceUnitUtil</span> <span class="n">persistenceUnitUtil</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">getEntityManagerFactory</span><span class="o">().</span><span class="na">getPersistenceUnitUtil</span><span class="o">();</span>
<span class="kt">boolean</span> <span class="n">isLoaded</span> <span class="o">=</span> <span class="n">persistenceUnitUtil</span><span class="o">.</span><span class="na">isLoaded</span><span class="o">(</span><span class="n">order</span><span class="o">.</span><span class="na">getMember</span><span class="o">());</span>
</code></pre></div>    </div>

  </div>
</details>

<p><br />
<br /></p>

<h2 id="1324-facade-레이어-추가">13.2.4 FACADE 레이어 추가</h2>

<p><img src="/assets/img/jpa_study/ch.13/pic-13-5.png" /></p>

<ul>
  <li>프리젠테이션 레이어와 서비스 레이어 사이에 FACADE 레이어를 하나 더 두고 뷰를 위한 프록시 초기화를 담당시킴</li>
  <li>프록시 초기화하려면 영속성 컨텍스트 필요하므로 FACADE 에서 트랜잭션을 시작해야 함</li>
</ul>

<p><br /></p>

<h3 id="facade-계층의-역할과-특징">FACADE 계층의 역할과 특징</h3>
<ul>
  <li>프리젠테이션 레이어 &lt;-&gt; 서비스 레이어 간 논리적 의존성 분리</li>
  <li>프리젠테이션 레이어에서 필요한 프록시 객체를 초기화함</li>
  <li>서비스 레이어를 호출해서 비즈니스 로직을 실행</li>
  <li>레포지토리를 직접 호출해서 뷰가 요구하는 엔티티 조회</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 강제 초기화 예시에 FACADE 레이어 추가</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">class</span> <span class="nc">OrderFacade</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">OrderService</span> <span class="n">orderService</span><span class="o">;</span>

  <span class="nd">@Transactional</span>  <span class="c1">// 영속성 컨텍스트 살아있어야 lazy loading 가능하므로 트랜잭션을 FACADE 레이어에서 시작</span>
  <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">findOrder</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="n">orderService</span><span class="o">.</span><span class="na">findOrder</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>

      <span class="n">order</span><span class="o">.</span><span class="na">getMember</span><span class="o">().</span><span class="na">getName</span><span class="o">();</span>  <span class="c1">// 프리젠테이션 레이어에서 필요한 프록시 객체를 미리 강제 초기화</span>

      <span class="k">return</span> <span class="n">order</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="kd">class</span> <span class="nc">OrderService</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">findOrder</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">orderRepository</span><span class="o">.</span><span class="na">findOrder</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><br />
<br /></p>

<h2 id="1325-준영속-상태와-지연-로딩의-문제점">13.2.5 준영속 상태와 지연 로딩의 문제점</h2>
<ul>
  <li>준영속 상태일 때 지연 로딩 문제 극복을 위한 방법들 사용해서 지연 로딩 문제 자체는 해결 가능</li>
  <li>하지만 이렇게 미리 초기화 하는 방법은 오류 발생 가능성이 높음
    <ul>
      <li>∵ 뷰에서 엔티티 사용할 때 초기화 여부 확인하기 위해 FACADE, 서비스 클래스까지 다 확인해야해서 실수하기 쉬움</li>
      <li>∴ 초기화되지 않은 프록시 엔티티를 뷰에서 조회하여 예외가 발생할 가능성 높음</li>
    </ul>
  </li>
  <li>또한 애플리케이션 로직과 뷰의 논리적 의존 관계가 발생
    <ul>
      <li>FACADE 로 어느정도 해소 가능하나 굉장히 번거로움</li>
    </ul>
  </li>
  <li>이러한 문제를 해결하려면 영속성 컨텍스트를 뷰까지 살아있게 해야함 =&gt; <strong>OSIV</strong></li>
</ul>

<p><br />
<br />
<br /></p>

<h1 id="133-osiv">13.3 OSIV</h1>
<ul>
  <li>Open Session In View
    <ul>
      <li>영속성 컨텍스트를 뷰까지 열어둔다는 의미</li>
    </ul>
  </li>
  <li>OSIV 는 하이버네이트에서 사용하는 용어
    <ul>
      <li>JPA에서는 OEIV(Open EntityManager In View)</li>
    </ul>
  </li>
</ul>

<p><br />
<br /></p>

<h1 id="1331-과거-osiv-요청-당-트랜잭션">13.3.1 과거 OSIV: 요청 당 트랜잭션</h1>

<p><img src="/assets/img/jpa_study/ch.13/pic-13-6.png" /></p>

<ul>
  <li>클라이언트의 요청이 들어오면 서블릿 필터나 스프링 인터셉터에서 영속성 컨텍스트 만들면서 트랜잭션 시작</li>
  <li>요청 끝날 때 트랜잭션과 영속성 컨텍스트를 함께 종료</li>
  <li>뷰에서도 영속성 컨텍스트가 살아있어서 지연 로딩 할 수 있음</li>
</ul>

<p><br /></p>

<h3 id="요청-당-트랜잭션-방식의-osiv-문제점">요청 당 트랜잭션 방식의 OSIV 문제점</h3>
<ul>
  <li>컨트롤러, 뷰 같은 프리젠테이션 레이어에서 엔티티 변경이 가능함
    <ul>
      <li>컨트롤러에서 엔티티 변경해서 뷰에 넘겨주면 OSIV는 뷰를 렌더링 후 트랜잭션을 커밋 =&gt; 영속성 컨텍스트 플러시 돼서 변경이 반영됨</li>
    </ul>
  </li>
  <li>문제를 해결하기 위해서는 프리젠테이션 레이어에서 엔티티 수정 못하도록 막아야 함
    <ul>
      <li><strong>엔티티를 읽기 전용 인터페이스로 제공</strong></li>
      <li><strong>엔티티 래핑</strong></li>
      <li><strong>DTO만 반환</strong></li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="엔티티를-읽기-전용-인터페이스로-제공">엔티티를 읽기 전용 인터페이스로 제공</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 읽기 전용 인터페이스</span>
<span class="kd">interface</span> <span class="nc">MemberView</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">();</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="c1">// 엔티티</span>
<span class="nd">@Entity</span>
<span class="kd">class</span> <span class="nc">Member</span> <span class="kd">implements</span> <span class="nc">MemberView</span> <span class="o">{</span>
  <span class="o">...</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="c1">// 서비스 레이어에서 entity를 읽기 전용 인터페이스로 반환</span>
<span class="kd">class</span> <span class="nc">MemberService</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nc">MemberView</span> <span class="nf">getMember</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">memberRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>프리젠테이션 레이어에는 실제 엔티티 대신 읽기 전용 메소드만 있는 인터페이스를 제공</li>
</ul>

<p><br /></p>

<h3 id="엔티티-래핑">엔티티 래핑</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MemberWrapper</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="nc">Member</span> <span class="n">member</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">MemberWrapper</span><span class="o">(</span><span class="nc">Member</span> <span class="n">member</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">member</span> <span class="o">=</span> <span class="n">member</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">member</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>읽기 전용 메소드만 가지고 있는 래퍼 객체를 만들어서 프리젠테이션 레이어에 제공</li>
</ul>

<p><br /></p>

<h3 id="dto만-반환">DTO만 반환</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MemberDTO</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

  <span class="c1">// Getter, Setter</span>
  <span class="o">...</span>

<span class="o">}</span>

<span class="o">...</span>

<span class="nc">MemberDTO</span> <span class="n">memberDTO</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MemberDTO</span><span class="o">();</span>
<span class="n">memberDTO</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">member</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
<span class="k">return</span> <span class="n">memberDTO</span><span class="o">;</span>
</code></pre></div></div>

<ul>
  <li>엔티티와 거의 비슷한 DTO 를 만들어서 값 채운다음 이걸 프리젠테이션 레이어에 반환</li>
  <li>이 방법 사용시엔 OSIV 사용 장점 살릴 수 없음(지연 로딩 못하고 미리 로딩하게 됨)</li>
</ul>

<p><br />
<br /></p>

<h2 id="1332-스프링-osiv-비즈니스-계층-트랜잭션">13.3.2 스프링 OSIV: 비즈니스 계층 트랜잭션</h2>
<ul>
  <li>요청 당 트랜잭션 방식은 위와 같은 문제점들로 인해 거의 사용 X
    <ul>
      <li>이러한 문제점들을 보완하여 비즈니스 계층에서만 트랜잭션을 유지하는 방식 =&gt; 스프링의 OSIV</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="스프링-프레임워크가-제공하는-osiv-라이브러리">스프링 프레임워크가 제공하는 OSIV 라이브러리</h3>
<ul>
  <li>spring-orm.jar 는 다양한 OSIV 클래스 제공</li>
  <li>OSIV 를 서블릿 필터에 적용할지 스프링 인터셉터에 적용할지에 따라 원하는 클래스 선택하면 됨
    <ul>
      <li><strong>하이버네이트 OSIV 서블릿 필터:</strong> <code class="language-plaintext highlighter-rouge">org.springframework.orm.jpa.hibernate4.support.OpenSessionInViewFilter</code></li>
      <li><strong>하이버네이트 OSIV 스프링 인터셉터:</strong> <code class="language-plaintext highlighter-rouge">org.springframework.orm.hibernate4.support.OpenSessionInViewInterceptor</code></li>
      <li><strong>JPA OEIV 서블릿 필터:</strong> <code class="language-plaintext highlighter-rouge">org.springframework.orm.jpa.support.OpenEntityManagerInViewFilter</code></li>
      <li><strong>JPA OEIV 스프링 인터셉터:</strong> <code class="language-plaintext highlighter-rouge">org.springframework.orm.jpa.support.OpenEntityManagerInViewInterceptor</code></li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="스프링-osiv-분석">스프링 OSIV 분석</h3>
<ul>
  <li>스프링 OSIV =&gt; 비즈니스 계층에서 트랜잭션을 사용하는 OSIV</li>
</ul>

<p><img src="/assets/img/jpa_study/ch.13/pic-13-7.png" /></p>

<ol>
  <li>
    <table>
      <tbody>
        <tr>
          <td>클라이언트 요청 들어오면 서블릿 필터</td>
          <td>스프링 인터셉터에서 영속성 컨텍스트 생성</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>서비스 레이어에서 <code class="language-plaintext highlighter-rouge">@Transactional</code> 로 트랜잭션 시작 시 1번에서 생성한 영속성 컨텍스트 찾아와서 트랜잭션 시작</li>
  <li>서비스 레이어 끝나면 트랜잭션 커밋, 영속성 컨텍스트 플러시, 영속성 컨텍스트는 종료시키지 않고 살려둠</li>
  <li>컨트롤러와 뷰까지 영속성 컨텍스트 유지되므로 조회한 엔티티는 영속 상태, 수정은 불가능(수정 사항이 DB 반영 안됨)</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>서블릿 필터</td>
          <td>스프링 인터셉터로 요청이 돌아오면 플러시 하지 않고 바로 영속성 컨텍스트를 종료</td>
        </tr>
      </tbody>
    </table>
  </li>
</ol>

<p><br /></p>

<h3 id="트랜잭션-없이-읽기">트랜잭션 없이 읽기</h3>
<ul>
  <li>트랜잭션 없이 엔티티 변경 후 영속성 컨텍스트 플러시하면 예외 발생</li>
  <li>변경 없이 조회만 할 때는 트랜잭션 없어도 됨 =&gt; <strong>트랜잭션 없이 읽기 (Nontransactional reads)</strong></li>
  <li>지연 로딩도 조회 기능이므로 트랜잭션 없이 읽기 가능</li>
</ul>

<p><br /></p>

<h3 id="스프링-osiv-주의사항">스프링 OSIV 주의사항</h3>
<ul>
  <li>프리젠테이션 레이어에서 엔티티 수정해도 수정 내용 DB 반영 안되지만 예외가 있음</li>
  <li>프리젠테이션 레이어에서 엔티티 수정 직후 트랜잭션을 시작하는 서비스 레이어 호출시 문제 발생</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 프리젠테이션 레이어</span>
<span class="kd">class</span> <span class="nc">Member</span> <span class="nc">Controller</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">viewMember</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="n">membrerSerivce</span><span class="o">.</span><span class="na">getMember</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="n">member</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">"XXX"</span><span class="o">);</span>  <span class="c1">// view 에서만 고객 이름을 X로 표시하기위해 수정. DB 반영은 의도 X</span>

    <span class="n">memberService</span><span class="o">.</span><span class="na">biz</span><span class="o">();</span>  <span class="c1">// 비즈니스 로직 호출</span>
    <span class="k">return</span> <span class="s">"view"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="c1">// 서비스 레이어</span>
<span class="kd">class</span> <span class="nc">MemberSservice</span> <span class="o">{</span>
  <span class="nd">@Transactional</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">biz</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// 비즈니스 로직 실행</span>
    <span class="o">...</span>

  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><img src="/assets/img/jpa_study/ch.13/pic-13-8.png" /></p>

<ol>
  <li>컨트롤러에서 Member entity 조회하고 member.setName(“XXX”) 로 name 수정</li>
  <li><code class="language-plaintext highlighter-rouge">biz()</code> 메소드 호출해서 트랜잭션 있는 비즈니스 로직 실행</li>
  <li>트랜잭션 AOP 동작하면서 영속성 컨텍스트에 트랜잭션을 시작 후 <code class="language-plaintext highlighter-rouge">biz()</code> 메소드 실행</li>
  <li><code class="language-plaintext highlighter-rouge">biz()</code> 메소드 끝나면 트랜잭션 AOP가 트랜잭션 커밋하고 영속성 컨텍스트 플러시</li>
  <li>변경 감지가 동작하며 Member entity 의 수정사항이 DB에 반영됨</li>
</ol>

<p><br /></p>

<ul>
  <li>이와 같은 문제를 해결하려면 트랜잭션 있는 비즈니스 로직을 모두 실행하고 난 후에 엔티티를 변경해야 함</li>
</ul>

<p><br />
<br /></p>

<h2 id="1333-osiv-정리">13.3.3 OSIV 정리</h2>
<ul>
  <li>스프링 OSIV 특징
    <ul>
      <li>요청 들어오면 끝날때 까지 같은 영속성 컨텍스트를 유지 =&gt; 한 번 조회한 엔티티는 요청 끝날 때 까지 영속 상태임</li>
      <li>엔티티 수정은 트랜잭션이 있는 계층에서만 동작, 프리젠테이션 계층은 지연 로딩을 포함한 조회만 가능</li>
    </ul>
  </li>
  <li>스프링 OSIV 단점
    <ul>
      <li>같은 영속성 컨텍스트를 여러 트랜잭션이 공유할 수 있음. 특히 트랜잭션 롤백 시 주의 요함</li>
      <li>프리젠테이션 레이어에서 엔티티 수정 후 비즈니스 로직 수행 시 엔티티 수정될 수 있음</li>
      <li>프리젠테이션 레이어에서 지연 로딩으로 인한 SQL 실행되므로 성능 튜닝시 확인할 범위가 넓음</li>
    </ul>
  </li>
  <li>OSIV는 같은 JVM 벗어난 원격 상황에서는 사용 불가
    <ul>
      <li>서버에서 JSON, XML 생성시엔 지연 로딩 되지만 클라이언트에서 연관된 엔티티 지연 로딩은 불가능</li>
      <li>따라서 클라이언트에서 필요한 데이터는 모두 JSON 생성해서 반환해야 함</li>
      <li>엔티티는 생각보다 자주 변경되므로 외부 API에는 완충 역할 할 수 있는 DTO 로 변환해서 노출하는 것이 안전함</li>
    </ul>
  </li>
</ul>

<p><br />
<br />
<br /></p>

<h3 id="134-너무-엄격한-계층">13.4 너무 엄격한 계층</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 프리젠테이션 레이어</span>
<span class="nd">@Controller</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">class</span> <span class="nc">OrderController</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">OrderService</span> <span class="n">orderService</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">OrderRepository</span> <span class="n">orderRepository</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">orderRequest</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">,</span> <span class="nc">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Long</span> <span class="n">id</span> <span class="o">=</span> <span class="n">orderService</span><span class="o">.</span><span class="na">order</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>   <span class="c1">// 상품 구매</span>

    <span class="c1">// 컨트롤러에서 리포지토리 직접 접근</span>
    <span class="nc">Order</span> <span class="n">orderResult</span> <span class="o">=</span> <span class="n">orderRepository</span><span class="o">.</span><span class="na">findOne</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"order"</span><span class="o">,</span> <span class="n">orderResult</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="c1">// 서비스 레이어</span>
<span class="nd">@Transcational</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">class</span> <span class="nc">OrderService</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">OrderRepository</span> <span class="n">orderRepository</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nc">Long</span> <span class="nf">order</span><span class="o">(</span><span class="n">order</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// 비즈니스 로직</span>
    <span class="o">...</span>

    <span class="k">return</span> <span class="n">orderRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="o">...</span>

<span class="c1">// 데이터 엑세스 레이어</span>
<span class="kd">class</span> <span class="nc">OrderRepository</span> <span class="o">{</span>
  <span class="nd">@PersistenceContext</span>
  <span class="nc">EntityManager</span> <span class="n">em</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">findOne</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">em</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><img src="/assets/img/jpa_study/ch.13/pic-13-9.png" /></p>

<ul>
  <li>OSIV를 사용하면 영속성 컨텍스트가 프리젠테이션 계층까지 유지됨</li>
  <li>따라서 위 예제처럼 단순한 엔티티 조회는 컨트롤러에서 리포지토리를 직접 호출해도 문제가 없음</li>
</ul>

</article>



<section class="tags">
  <strong>Tags:</strong> <a href="/tag/jpa">jpa</a>,&nbsp;<a href="/tag/web-application">web-application</a>,&nbsp;<a href="/tag/persistence-management">persistence-management</a>,&nbsp;<a href="/tag/web">web</a>,&nbsp;<a href="/tag/application">application</a>,&nbsp;<a href="/tag/persistence">persistence</a>,&nbsp;<a href="/tag/management">management</a>,&nbsp;<a href="/tag/lazy-loading">lazy-loading</a>,&nbsp;<a href="/tag/osiv">osiv</a>
</section>



<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
      <a href="//twitter.com/share?text=%5B%EC%9E%90%EB%B0%94+ORM+%ED%91%9C%EC%A4%80+JPA+%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%5D+13%EC%9E%A5.+%EC%9B%B9+%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%EA%B3%BC+%EC%98%81%EC%86%8D%EC%84%B1+%EA%B4%80%EB%A6%AC&url=https%3A%2F%2Fsungunjo.github.io%2Fjpa-study%2F2022%2F03%2F23%2Fch.13.web-application-and-persistence-management.html&via="
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
        <i class="fa fa-twitter-square fa-lg"></i>
      </a>
    
    
    
    
    
    
    
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=%5B%EC%9E%90%EB%B0%94+ORM+%ED%91%9C%EC%A4%80+JPA+%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%5D+13%EC%9E%A5.+%EC%9B%B9+%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%EA%B3%BC+%EC%98%81%EC%86%8D%EC%84%B1+%EA%B4%80%EB%A6%AC&u=https%3A%2F%2Fsungunjo.github.io%2Fjpa-study%2F2022%2F03%2F23%2Fch.13.web-application-and-persistence-management.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
      <a href="//www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fsungunjo.github.io%2Fjpa-study%2F2022%2F03%2F23%2Fch.13.web-application-and-persistence-management.html"
        onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;">
        <i class="fa fa-linkedin-square fa-lg"></i>
      </a>
    
    
    
    
  
    
    
    
    
      <a href="//plus.google.com/share?title=%5B%EC%9E%90%EB%B0%94+ORM+%ED%91%9C%EC%A4%80+JPA+%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%5D+13%EC%9E%A5.+%EC%9B%B9+%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%EA%B3%BC+%EC%98%81%EC%86%8D%EC%84%B1+%EA%B4%80%EB%A6%AC&url=https%3A%2F%2Fsungunjo.github.io%2Fjpa-study%2F2022%2F03%2F23%2Fch.13.web-application-and-persistence-management.html"
        onclick="window.open(this.href, 'google-plus-share', 'width=550,height=255');return false;">
        <i class="fa fa-google-plus-square fa-lg"></i>
      </a>
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
      <a href="//www.pinterest.com/pin/create/button/?description=%5B%EC%9E%90%EB%B0%94+ORM+%ED%91%9C%EC%A4%80+JPA+%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%5D+13%EC%9E%A5.+%EC%9B%B9+%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%EA%B3%BC+%EC%98%81%EC%86%8D%EC%84%B1+%EA%B4%80%EB%A6%AC&url=https%3A%2F%2Fsungunjo.github.io%2Fjpa-study%2F2022%2F03%2F23%2Fch.13.web-application-and-persistence-management.html&media=https://sungunjo.github.io/assets/instacode.png"
        onclick="window.open(this.href, 'pinterest-share', 'width=550,height=255');return false;">
        <i class="fa fa-pinterest-square fa-lg"></i>
      </a>
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
      <a href="//www.reddit.com/submit" onclick="window.location = '//www.reddit.com/submit?url=' + encodeURIComponent('https://sungunjo.github.io/jpa-study/2022/03/23/ch.13.web-application-and-persistence-management.html') + '&title=[자바 ORM 표준 JPA 프로그래밍] 13장. 웹 애플리케이션과 영속성 관리'; return false">
        <i class="fa fa-reddit-square fa-lg"></i>
      </a>
    
    
  
    
    
    
    
    
    
    
    
  
</section>




<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'sungunjo-github-io';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">Development Stash</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
				
	
	<li class="nav-link"><a href="/about/">About</a>
	

	

	

	
	<li class="nav-link"><a href="/posts/">Posts</a>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	


      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:sungunjo.dev@gmail.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">sungunjo.dev@gmail.com</span>
          </a>
        </li>

        
          
        
          
        
          
          <li>
            <a href="https://github.com/sungunjo" title="Fork me on GitHub">
              <i class="fa fa-github"></i>
              <span class="username">sungunjo</span>
            </a>
          </li>
          
        
          
          <li>
            <a href="https://www.linkedin.com/in/sungunjo" title="Connect with me on LinkedIn">
              <i class="fa fa-linkedin"></i>
              <span class="username">SungUn Jo</span>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">개발 공부 블로그</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/js/lightbox.min.js"></script>
<script src="//unpkg.com/popper.js@1"></script>
<script src="//unpkg.com/tippy.js@5"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });

	// Enable tooltips via Tippy.js
	if (Array.isArray(window.tooltips)) {
		window.tooltips.forEach(function(tooltip) {
			var selector = tooltip[0];
			var config = tooltip[1];
			tippy(selector, config);
		})
	}
});

</script>




<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-156645046-1', 'auto');
  ga('send', 'pageview', {
    'page': '/jpa-study/2022/03/23/ch.13.web-application-and-persistence-management.html',
    'title': '[자바 ORM 표준 JPA 프로그래밍] 13장. 웹 애플리케이션과 영속성 관리'
  });
</script>



  </body>

</html>
